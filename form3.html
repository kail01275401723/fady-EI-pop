<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>عرض البيانات المحفوظة</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style>
  body { font-family: sans-serif; text-align: center; margin-top: 40px; direction: rtl; }
  table { border-collapse: collapse; margin: 20px auto; width: 80%; }
  th, td { border: 1px solid #aaa; padding: 8px; text-align: center; }
  th { background: #eee; }
  button { padding: 10px 20px; margin-top: 10px; cursor: pointer; }
</style>
</head>
<body>
  <h2>📄 البيانات المحفوظة</h2>
  <table id="dataTable">
    <thead>
      <tr><th>الاسم</th><th>رقم الموبايل</th><th>العنوان</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <button onclick="exportExcel()">📤 تصدير إلى Excel</button>

  <script>
    const savedData = localStorage.getItem("lastData");
    if (savedData) {
      const data = JSON.parse(savedData);
      const row = `<tr><td>${data.name}</td><td>${data.phone}</td><td>${data.address}</td></tr>`;
      document.querySelector("#dataTable tbody").innerHTML = row;
    }

    function exportExcel() {
      const table = document.getElementById("dataTable");
      const wb = XLSX.utils.table_to_book(table, { sheet: "بيانات" });
      XLSX.writeFile(wb, "البيانات.xlsx");
    }
  </script>
</body>
</html>
